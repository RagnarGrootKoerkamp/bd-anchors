This tool measures the empirical density of bidirectional anchor as introduced by
[[https://doi.org/10.1109/tkde.2022.3231780][Loukides, Pissis, and Sweering]].

#+begin_src text
Usage: bd-anchors [OPTIONS]

Options:
  -n, --n <N>          Length of the generated random string [default: 100000]
  -s, --sigma <SIGMA>  Alphabet size [default: 4]
  -l, --l <L>          Test kmers up to l [default: 40]
  -r, --r <R>          Test r (reduction constant) up to this [default: 10]
#+end_src

For example: =cargo run -r -- -n 100000 -l 100 -s 4 -r 10=

Results:
- For large alphabet (256): density equals $2/(l+1-r)$, and $r=0$ has lowest density for
  $l\leq 40$.
- For small alphabet (4): density is over $2\times$ worse than $2/(l+1-r)$ for
  $r=0$ and $l$ large, and around 10% worse for large $r$.
  The best $r$ increases slowly, roughly linear in $\log_2(l)$:
  - $l\leq 8$: $r=0$
  - $l\leq 15$: $r=1$
  - $l\leq 27$: $r=2$
  - $l\leq 52$: $r=3$
  - $53 \leq l \leq 100$: $r=4$

Full results for size 4 alphabet. =x/y= indicates expected density $x =
2/(l+1-r)$, and measured density $y$. Best results in each row is marked with a *.
#+begin_src txt
 l         r= 0         r= 1         r= 2         r= 3         r= 4         r= 5         r= 6
 1: 1.000/1.000*
 2: 0.667/0.687* 1.000/1.000
 3: 0.500/0.508* 0.667/0.703  1.000/1.000
 4: 0.400/0.428* 0.500/0.536  0.667/0.707  1.000/1.000
 5: 0.333/0.363* 0.400/0.428  0.500/0.535  0.667/0.708  1.000/1.000
 6: 0.286/0.327* 0.333/0.362  0.400/0.434  0.500/0.537  0.667/0.708  1.000/1.000
 7: 0.250/0.296* 0.286/0.313  0.333/0.361  0.400/0.433  0.500/0.537  0.667/0.708  1.000/1.000
 8: 0.222/0.274* 0.250/0.277  0.286/0.311  0.333/0.361  0.400/0.433  0.500/0.537  0.667/0.708
 9: 0.200/0.256  0.222/0.248* 0.250/0.273  0.286/0.310  0.333/0.361  0.400/0.433  0.500/0.537
10: 0.182/0.240  0.200/0.226* 0.222/0.243  0.250/0.272  0.286/0.310  0.333/0.361  0.400/0.433
11: 0.167/0.227  0.182/0.208* 0.200/0.219  0.222/0.242  0.250/0.272  0.286/0.310  0.333/0.361
12: 0.154/0.216  0.167/0.192* 0.182/0.200  0.200/0.218  0.222/0.242  0.250/0.272  0.286/0.310
13: 0.143/0.205  0.154/0.179* 0.167/0.184  0.182/0.198  0.200/0.217  0.222/0.241  0.250/0.272
14: 0.133/0.197  0.143/0.168* 0.154/0.171  0.167/0.182  0.182/0.198  0.200/0.217  0.222/0.241
15: 0.125/0.188  0.133/0.159* 0.143/0.159  0.154/0.168  0.167/0.182  0.182/0.198  0.200/0.217
16: 0.118/0.181  0.125/0.151  0.133/0.149* 0.143/0.157  0.154/0.168  0.167/0.181  0.182/0.198
17: 0.111/0.174  0.118/0.143  0.125/0.140* 0.133/0.146  0.143/0.156  0.154/0.168  0.167/0.181
18: 0.105/0.168  0.111/0.137  0.118/0.132* 0.125/0.138  0.133/0.146  0.143/0.156  0.154/0.168
19: 0.100/0.162  0.105/0.131  0.111/0.126* 0.118/0.130  0.125/0.137  0.133/0.146  0.143/0.156
20: 0.095/0.157  0.100/0.125  0.105/0.120* 0.111/0.123  0.118/0.129  0.125/0.137  0.133/0.146
21: 0.091/0.152  0.095/0.121  0.100/0.114* 0.105/0.117  0.111/0.122  0.118/0.129  0.125/0.137
22: 0.087/0.147  0.091/0.116  0.095/0.109* 0.100/0.111  0.105/0.116  0.111/0.122  0.118/0.129
23: 0.083/0.143  0.087/0.112  0.091/0.104* 0.095/0.106  0.100/0.110  0.105/0.116  0.111/0.122
24: 0.080/0.139  0.083/0.108  0.087/0.100* 0.091/0.102  0.095/0.105  0.100/0.110  0.105/0.116
25: 0.077/0.135  0.080/0.105  0.083/0.096* 0.087/0.097  0.091/0.101  0.095/0.105  0.100/0.110
26: 0.074/0.131  0.077/0.102  0.080/0.093* 0.083/0.093  0.087/0.097  0.091/0.101  0.095/0.105
27: 0.071/0.128  0.074/0.099  0.077/0.090* 0.080/0.090  0.083/0.093  0.087/0.096  0.091/0.101
28: 0.069/0.125  0.071/0.096  0.074/0.087  0.077/0.086* 0.080/0.089  0.083/0.092  0.087/0.096
29: 0.067/0.122  0.069/0.094  0.071/0.084  0.074/0.083* 0.077/0.086  0.080/0.089  0.083/0.092
30: 0.065/0.119  0.067/0.091  0.069/0.081  0.071/0.081* 0.074/0.083  0.077/0.086  0.080/0.089
31: 0.062/0.116  0.065/0.089  0.067/0.079  0.069/0.078* 0.071/0.080  0.074/0.083  0.077/0.085
32: 0.061/0.113  0.062/0.086  0.065/0.076  0.067/0.075* 0.069/0.077  0.071/0.080  0.074/0.082
33: 0.059/0.111  0.061/0.085  0.062/0.074  0.065/0.073* 0.067/0.075  0.069/0.077  0.071/0.080
34: 0.057/0.108  0.059/0.083  0.061/0.072  0.062/0.071* 0.065/0.072  0.067/0.075  0.069/0.077
35: 0.056/0.107  0.057/0.081  0.059/0.070  0.061/0.069* 0.062/0.070  0.065/0.072  0.067/0.074
36: 0.054/0.104  0.056/0.079  0.057/0.068  0.059/0.067* 0.061/0.068  0.062/0.070  0.065/0.072
37: 0.053/0.103  0.054/0.078  0.056/0.067  0.057/0.065* 0.059/0.066  0.061/0.068  0.062/0.070
38: 0.051/0.100  0.053/0.076  0.054/0.065  0.056/0.063* 0.057/0.064  0.059/0.066  0.061/0.068
39: 0.050/0.098  0.051/0.075  0.053/0.063  0.054/0.062* 0.056/0.063  0.057/0.064  0.059/0.066
40: 0.049/0.097  0.050/0.073  0.051/0.062  0.053/0.060* 0.054/0.061  0.056/0.062  0.057/0.064
#+end_src
